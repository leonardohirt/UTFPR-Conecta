<app-main-navbar></app-main-navbar>

<div class="min-h-screen bg-gray-50 flex flex-col items-center py-10">

  <div class="max-w-6xl w-full bg-white p-6 rounded-2xl shadow overflow-x-auto">

    <!-- Cabeçalho -->
    <div class="flex flex-col sm:flex-row justify-between items-center mb-6 gap-4">
      <h1 class="text-2xl font-semibold text-center sm:text-left">Gerenciar Eventos</h1>
      <app-button color="primary-yellow" (click)="openCreatePage()">+ Novo Evento</app-button>
    </div>

    <!-- Estados -->
    <div *ngIf="loading" class="text-center py-10 text-gray-500">
      Carregando eventos...
    </div>

    <div *ngIf="!currentUserId" class="text-center py-10 text-red-500 font-medium">
      Faça login para gerenciar seus eventos.
    </div>

    <div *ngIf="!loading && events.length === 0 && currentUserId" class="text-center py-10 text-gray-500">
      Nenhum evento cadastrado.
    </div>

    <!-- Tabela de eventos -->
    <div *ngIf="events.length > 0" class="overflow-x-auto">
      <table class="w-full text-left table-auto text-sm border-collapse">
        <thead>
          <tr class="border-b font-medium bg-gray-100">
            <th class="p-2">Nome</th>
            <th class="p-2">Categoria</th>
            <th class="p-2">Data</th>
            <th class="p-2">Ações</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-200">
          <tr *ngFor="let ev of events" class="hover:bg-gray-50">
            <td class="p-2">{{ ev.nome }}</td>
            <td class="p-2">{{ ev.categoria }}</td>
            <td class="p-2">{{ ev.data }}</td>
            <td class="p-2 flex flex-wrap gap-2">
              <ng-container *ngIf="ev.criado_por === currentUserId">
                <app-button color="primary-yellow" (click)="openEditPage(ev.id)">Editar</app-button>
                <app-button color="primary-yellow" (click)="confirmDelete(ev.id)">Excluir</app-button>
              </ng-container>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

  </div>

  <!-- Modal -->
  <div *ngIf="showModal" class="fixed inset-0 z-50 flex items-center justify-center">
    <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" (click)="closeModal()"></div>
    <div class="relative bg-white rounded-xl shadow-xl p-6 w-full max-w-sm sm:max-w-md mx-4 z-50">
      <div class="flex items-start gap-4">
        <div>
          <svg *ngIf="modalType === 'success'" class="w-8 h-8 text-green-500" fill="none" viewBox="0 0 24 24">
            <path d="M5 13l4 4L19 7" stroke="currentColor" stroke-width="2"/>
          </svg>
          <svg *ngIf="modalType === 'error'" class="w-8 h-8 text-red-500" fill="none" viewBox="0 0 24 24">
            <path d="M6 18L18 6M6 6l12 12" stroke="currentColor" stroke-width="2"/>
          </svg>
        </div>
        <div class="flex-1">
          <h3 class="text-lg font-semibold">{{ modalType === 'success' ? 'Sucesso' : 'Erro' }}</h3>
          <p class="mt-1 text-gray-700">{{ modalMessage }}</p>
        </div>
        <button (click)="closeModal()" class="text-gray-400 hover:text-gray-600">✕</button>
      </div>
      <div class="mt-4 flex justify-end gap-2" *ngIf="eventToDeleteId">
        <app-button color="primary-yellow" (click)="closeModal()">Cancelar</app-button>
        <app-button color="primary-yellow" (click)="deleteEvent()">Confirmar Exclusão</app-button>
      </div>
    </div>
  </div>

</div>

<app-footer></app-footer>
